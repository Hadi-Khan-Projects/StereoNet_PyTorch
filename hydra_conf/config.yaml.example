hydra:
  run:
    dir: ./logging/${now:%Y-%m-%d}/${now:%H-%M-%S}/hydra

stereonet_config:
  _target_: stereonet.types.StereoNetConfig
  global_settings:
    _target_: stereonet.types.GlobalSettings
    random_seed: 42  # type=int, help="Seed to set the torch random generator for reproducible training runs"
    devices:
      _target_: stereonet.types.Devices
      num: 1  # type=int, help="Number of devices to use during training"
      type: "gpu"  # type=str, help="Type of device to use during training"

  logging:
    _target_: stereonet.types.Logging
    lightning_log_root: "./logging/${now:%Y-%m-%d}/${now:%H-%M-%S}"  # type=str, help="Root path to output logs files to"

  model:
    _target_: stereonet.types.StereoNetModel
    in_channels: 1
    k_downsampling_layers: 3
    k_refinement_layers: 3
    candidate_disparities: 256


  training:
    _target_: stereonet.types.Training
    fast_dev_run: true  # type=bool, help="Whether or not to run a fast dev run of the training loop"
    min_epochs: 20  # type=int, help="Number of iterations of training over the full train dataset"
    max_epochs: 50  # type=int, help="Number of iterations of training over the full train dataset"
    optimizer:
      _target_: torch.optim.RMSprop
      _partial_: true
      lr: 2.54e-4  # type=float, help="Starting learning rate"
      weight_decay: 0.0001
    scheduler:
      _target_: torch.optim.lr_scheduler.ExponentialLR
      _partial_: true
      gamma: 0.9
    loader:
      _target_: stereonet.types.Loader
      batch_size: 1  # type=int, help='Number of examples for data loading.'
    data:
      # - _target_: stereonet.types.SceneflowData
      #   root_path: "E:\\Sceneflow"  # type=str, help='Path to the root of the Sceneflow depth files'
      #   transforms:
      #     - name: rescale
      #     - name: center_crop
      #       properties:
      #         scale: 0.925  # type=float, help='Center crop percentage to decrease GPU memory'
      - _target_: stereonet.types.KeystoneDepthData
        root_path: "E:\\Keystone\\projects\\grail\\slowglass\\2-BBox\\annotation_results"  # type=str, help='Path to the root of the Keystone depth files'
        split_ratio: 0.9  # type=float, help='Train:Test split ratio.'
        max_size:
          - 650
          - 650
        # transforms:
        #   - _target_: torchvision.transforms.CenterCrop
        #     size: 
        #       - 500
        #       - 500
    debug:
      _target_: stereonet.types.DataDebug
      enabled: False  # type=bool, help="Whether or not to use the following debugging flags"
      limit_train_batches: 10_000  # type=int, help="Debugging, how many batches to train on"

  # validation:
  #   _target_: stereonet.types.Validation
  #   loader:
  #     _target_: stereonet.types.Loader
  #     batch_size: 1  # type=int, help='Number of examples for data loading.'
  #   data:
  #     - _target_: stereonet.types_hydra.KeystoneDepthData
  #       root_path: "E:\\Keystone\\projects\\grail\\slowglass\\2-BBox\\annotation_results"  # type=str, help='Path to the root of the Keystone depth files'
  #       split_ratio: 0.9  # type=float, help='Train:Test split ratio.'
  #       max_size:
  #         - 650
  #         - 650